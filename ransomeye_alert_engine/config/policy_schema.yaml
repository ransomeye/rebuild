# Path and File Name : /home/ransomeye/rebuild/ransomeye_alert_engine/config/policy_schema.yaml
# Author: nXxBku0CKFAJCBN3X1g3bQk7OxYQylg8CMw1iGsq7gU
# Details of functionality of this file: JSON schema definition for policy rule validation

$schema: "http://json-schema.org/draft-07/schema#"
type: object
required:
  - rules
properties:
  rules:
    type: array
    minItems: 1
    items:
      type: object
      required:
        - rule_name
        - severity
        - condition
        - action
      properties:
        rule_name:
          type: string
          minLength: 1
          maxLength: 255
        severity:
          type: string
          enum: [low, medium, high, critical]
        condition:
          type: object
          required:
            - type
          properties:
            type:
              type: string
              enum: [match, regex, contains, equals, range]
            field:
              type: string
            value:
              oneOf:
                - type: string
                - type: number
                - type: array
            pattern:
              type: string
            min:
              type: number
            max:
              type: number
          additionalProperties: false
        action:
          type: string
          enum: [block_ip, trigger_ai, log_only, escalate, quarantine]
        description:
          type: string
        enabled:
          type: boolean
          default: true
        metadata:
          type: object
          additionalProperties: true
      additionalProperties: false
  version:
    type: string
  policy_name:
    type: string
  description:
    type: string
additionalProperties: false

